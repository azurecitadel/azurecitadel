{{/* Series Progress Indicator - reuse computed values */}}
{{ $wholeSeries := index .Scratch.Values "wholeSeries" }}
{{ $currentIndex := index .Scratch.Values "currentIndex" }}
{{ if not $currentIndex }}{{ $currentIndex = 0 }}{{ end }}
<div class="series-progress-container">
    {{ if eq .Layout "series" }}
        <div class="series-name">{{ .Title }}</div>
    {{ else }}
        <div class="series-name"><a href="javascript:void(0);" onclick="document.querySelector('h1')?.scrollIntoView({behavior:'smooth'})" style="color: inherit; text-decoration: none; cursor: pointer;">{{ .Title }}</a></div>
    {{ end }}
    <div class="series-controls">
        {{ with index .Scratch.Values "prevInSeries" }}
            <a class="btn-octicon series-btn" href="{{ .Permalink }}" aria-label="Previous in series: {{ .Title }}" title="{{ .Title }}">{{- partial "octicon" (dict "icon" "chevron-left" "height" 16) -}}</a>
        {{ else }}
            <span class="btn-octicon series-btn is-disabled" aria-disabled="true" title="No previous page">{{- partial "octicon" (dict "icon" "chevron-left" "height" 16) -}}</span>
        {{ end }}
        <div class="series-progress" aria-label="Series progress: {{ add $currentIndex 1 }} of {{ len $wholeSeries }}">
        {{ range $index, $page := $wholeSeries }}
            {{ $status := "future" }}
            {{ if lt $index $currentIndex }}{{ $status = "completed" }}{{ end }}
            {{ if eq $index $currentIndex }}{{ $status = "current" }}{{ end }}
            {{ if eq $index $currentIndex }}
                <div class="progress-bar progress-bar--{{ $status }}"
                     title="{{ $page.Title }}">
                </div>
            {{ else }}
                <a href="{{ $page.Permalink }}"
                   class="progress-bar progress-bar--{{ $status }}"
                   title="{{ $page.Title }}"
                   aria-label="Go to {{ $page.Title }}">
                </a>
            {{ end }}
        {{ end }}
        </div>
        {{ with index .Scratch.Values "nextInSeries" }}
            <a class="btn-octicon series-btn" href="{{ .Permalink }}" aria-label="Next in series: {{ .Title }}" title="{{ .Title }}">{{- partial "octicon" (dict "icon" "chevron-right" "height" 16) -}}</a>
        {{ else }}
            <span class="btn-octicon series-btn is-disabled" aria-disabled="true" title="No next page">{{- partial "octicon" (dict "icon" "chevron-right" "height" 16) -}}</span>
        {{ end }}
    </div>
</div>